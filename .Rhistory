mx_mzdz_data <- rbind(p1_mx_data, p2_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
ggplot(data = mx_mzdz_data, mapping = aes(x = Confounder, y = Power, color = Variable)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 2 - MZ & DZ vs. DZ-only Power
p5_mx_data <- paper_power %>%
filter(g == 0) %>%
dplyr::select("b", "p5", "PGS") %>%
mutate(Variable = "CT", Sample = "DZ") %>%
rename(Confounder = b, Power = p5)
p6_mx_data <- paper_power %>%
filter(b == 0) %>%
dplyr::select("g", "p6", 'PGS') %>%
mutate(Variable = "SI", Sample = "DZ") %>%
rename(Confounder = g, Power = p6)
mx_dz_data <- rbind(p5_mx_data, p6_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
full_mx_data <- rbind(mx_mzdz_data, mx_dz_data)
ggplot(data = full_mx_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Sample)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("DZ" = "dotted", "MZ & DZ" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 3
ext_estimates <- read.csv("2024-06-04_mx_estimates_ext.csv")
ext_power <- read.csv("2024-06-04_mx_power_ext.csv")
ext_power <- ext_power %>%
rename(`CT` = g, `SI` = b, `CT (m1)` = p1,
`SI (m2)` = p2, `CT (m3)` = p3, `SI (m3)` = p4)
data_noCT <- ext_power[ext_power$CT == 0, ]
# Gather the data for plotting
data_noCT_long <- gather(data_noCT, key = "variable", value = "value",`CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noCT_long, aes(x = SI, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Sibling Interaction",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 4
# Filter the data for b = 0
data_noSI <- ext_power[ext_power$SI== 0, ]
# Gather the data for plotting
data_noSI_long <- gather(data_noSI, key = "variable", value = "value", `CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noSI_long, aes(x = CT, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Cultural Transmission",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 5
gee_power <- read.csv("paper_gee_power.csv")
gee_est <- read.csv("paper_gee_estimates.csv")
p1_gee_data <- gee_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_gee_data <- gee_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
gee_mzdz_data <- rbind(p1_gee_data, p2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
p1_gee_data <- gee_power %>%
filter(g == 0) %>%
dplyr::select("b", "p5", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p5)
p2_gee_data <- gee_power %>%
filter(b == 0) %>%
dplyr::select("g", "p6", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p6)
gee_mzdz_data <- rbind(p1_gee_data, p2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
p1_gee_data <- gee_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_gee_data <- gee_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
gee_mzdz_data <- rbind(p1_gee_data, p2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
paper_estimates <- read.csv("paper_mx_estimates.csv")
# Plot 1 - MZ & DZ Estimate
library(tidyverse)
e1_mx_data <- paper_estimates %>%
filter(g == 0) %>%
dplyr::select("b", "e1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Estimate = e1)
e2_mx_data <- paper_estimates %>%
filter(b == 0) %>%
dplyr::select("g", "e2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Estimate = e2)
mx_mzdz_data <- rbind(e1_mx_data, e2_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
ggplot(data = mx_mzdz_data, mapping = aes(x = Confounder, y = Estimate, color = Variable)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 2 - MZ & DZ vs. DZ-only Estimate
e5_mx_data <- paper_estimates %>%
filter(g == 0) %>%
dplyr::select("b", "e5", "PGS") %>%
mutate(Variable = "CT", Sample = "DZ") %>%
rename(Confounder = b, Estimate = e5)
e6_mx_data <- paper_estimates %>%
filter(b == 0) %>%
dplyr::select("g", "e6", 'PGS') %>%
mutate(Variable = "SI", Sample = "DZ") %>%
rename(Confounder = g, Estimate = e6)
mx_dz_data <- rbind(e5_mx_data, e6_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
full_mx_data <- rbind(mx_mzdz_data, mx_dz_data)
ggplot(data = full_mx_data, mapping = aes(x = Confounder, y = Estimate, color = Variable, linetype = Sample)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("DZ" = "dotted", "MZ & DZ" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 5
gee_est <- read.csv("paper_gee_estimates.csv")
e1_gee_data <- gee_est %>%
filter(g == 0) %>%
dplyr::select("b", "e1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Estimate = e1)
e2_gee_data <- gee_est %>%
filter(b == 0) %>%
dplyr::select("g", "e2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Estimate = e2)
gee_mzdz_data <- rbind(e1_gee_data, e2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Estimate, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
devtools::install_github("josefinabernardo/gnomesims", build_vignettes = TRUE, force = TRUE)
library(gnomesims)
gee_data <- gnomesims::gnome_gee_simulation(ct = seq(0,.1,.02), si = seq(0,.1,.02),
nloci = 100,
npgsloci = c(2, 5, 10, 15))
detach("package:gnomesims", unload = TRUE)
devtools::install_github("josefinabernardo/gnomesims", build_vignettes = TRUE, force = TRUE)
library(gnomesims)
gee_data <- gnomesims::gnome_gee_simulation(ct = seq(0,.1,.02), si = seq(0,.1,.02),
nloci = 100,
npgsloci = c(2, 5, 10, 15))
gee_power <- gee_data$power
gee_estimates <- gee_data$params
write.csv(gee_estimates, file = "paper_gee_estimates.csv", row.names = TRUE)
write.csv(gee_power, file = "paper_gee_power.csv", row.names = TRUE)
paper_power <- read.csv("paper_mx_power.csv")
paper_estimates <- read.csv("paper_mx_estimates.csv")
# Plot 1 - MZ & DZ Power
library(tidyverse)
p1_mx_data <- paper_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_mx_data <- paper_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
mx_mzdz_data <- rbind(p1_mx_data, p2_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
ggplot(data = mx_mzdz_data, mapping = aes(x = Confounder, y = Power, color = Variable)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 2 - MZ & DZ vs. DZ-only Power
p5_mx_data <- paper_power %>%
filter(g == 0) %>%
dplyr::select("b", "p5", "PGS") %>%
mutate(Variable = "CT", Sample = "DZ") %>%
rename(Confounder = b, Power = p5)
p6_mx_data <- paper_power %>%
filter(b == 0) %>%
dplyr::select("g", "p6", 'PGS') %>%
mutate(Variable = "SI", Sample = "DZ") %>%
rename(Confounder = g, Power = p6)
mx_dz_data <- rbind(p5_mx_data, p6_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
full_mx_data <- rbind(mx_mzdz_data, mx_dz_data)
ggplot(data = full_mx_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Sample)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("DZ" = "dotted", "MZ & DZ" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 3
ext_estimates <- read.csv("2024-06-04_mx_estimates_ext.csv")
ext_power <- read.csv("2024-06-04_mx_power_ext.csv")
ext_power <- ext_power %>%
rename(`CT` = g, `SI` = b, `CT (m1)` = p1,
`SI (m2)` = p2, `CT (m3)` = p3, `SI (m3)` = p4)
data_noCT <- ext_power[ext_power$CT == 0, ]
# Gather the data for plotting
data_noCT_long <- gather(data_noCT, key = "variable", value = "value",`CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noCT_long, aes(x = SI, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Sibling Interaction",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 4
# Filter the data for b = 0
data_noSI <- ext_power[ext_power$SI== 0, ]
# Gather the data for plotting
data_noSI_long <- gather(data_noSI, key = "variable", value = "value", `CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noSI_long, aes(x = CT, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Cultural Transmission",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 5
gee_power <- read.csv("paper_gee_power.csv")
gee_est <- read.csv("paper_gee_estimates.csv")
p1_gee_data <- gee_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_gee_data <- gee_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
gee_mzdz_data <- rbind(p1_gee_data, p2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
paper_estimates <- read.csv("paper_mx_estimates.csv")
# Plot 1 - MZ & DZ Estimate
library(tidyverse)
e1_mx_data <- paper_estimates %>%
filter(g == 0) %>%
dplyr::select("b", "e1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Estimate = e1)
e2_mx_data <- paper_estimates %>%
filter(b == 0) %>%
dplyr::select("g", "e2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Estimate = e2)
mx_mzdz_data <- rbind(e1_mx_data, e2_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
ggplot(data = mx_mzdz_data, mapping = aes(x = Confounder, y = Estimate, color = Variable)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 2 - MZ & DZ vs. DZ-only Estimate
e5_mx_data <- paper_estimates %>%
filter(g == 0) %>%
dplyr::select("b", "e5", "PGS") %>%
mutate(Variable = "CT", Sample = "DZ") %>%
rename(Confounder = b, Estimate = e5)
e6_mx_data <- paper_estimates %>%
filter(b == 0) %>%
dplyr::select("g", "e6", 'PGS') %>%
mutate(Variable = "SI", Sample = "DZ") %>%
rename(Confounder = g, Estimate = e6)
mx_dz_data <- rbind(e5_mx_data, e6_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
full_mx_data <- rbind(mx_mzdz_data, mx_dz_data)
ggplot(data = full_mx_data, mapping = aes(x = Confounder, y = Estimate, color = Variable, linetype = Sample)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("DZ" = "dotted", "MZ & DZ" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 5
gee_est <- read.csv("paper_gee_estimates.csv")
e1_gee_data <- gee_est %>%
filter(g == 0) %>%
dplyr::select("b", "e1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Estimate = e1)
e2_gee_data <- gee_est %>%
filter(b == 0) %>%
dplyr::select("g", "e2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Estimate = e2)
gee_mzdz_data <- rbind(e1_gee_data, e2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Estimate, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
paper_power <- read.csv("paper_mx_power.csv")
paper_estimates <- read.csv("paper_mx_estimates.csv")
# Plot 1 - MZ & DZ Power
library(tidyverse)
p1_mx_data <- paper_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_mx_data <- paper_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
mx_mzdz_data <- rbind(p1_mx_data, p2_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
ggplot(data = mx_mzdz_data, mapping = aes(x = Confounder, y = Power, color = Variable)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 2 - MZ & DZ vs. DZ-only Power
p5_mx_data <- paper_power %>%
filter(g == 0) %>%
dplyr::select("b", "p5", "PGS") %>%
mutate(Variable = "CT", Sample = "DZ") %>%
rename(Confounder = b, Power = p5)
p6_mx_data <- paper_power %>%
filter(b == 0) %>%
dplyr::select("g", "p6", 'PGS') %>%
mutate(Variable = "SI", Sample = "DZ") %>%
rename(Confounder = g, Power = p6)
mx_dz_data <- rbind(p5_mx_data, p6_mx_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%")))
full_mx_data <- rbind(mx_mzdz_data, mx_dz_data)
ggplot(data = full_mx_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Sample)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("DZ" = "dotted", "MZ & DZ" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 3
ext_estimates <- read.csv("2024-06-04_mx_estimates_ext.csv")
ext_power <- read.csv("2024-06-04_mx_power_ext.csv")
ext_power <- ext_power %>%
rename(`CT` = g, `SI` = b, `CT (m1)` = p1,
`SI (m2)` = p2, `CT (m3)` = p3, `SI (m3)` = p4)
data_noCT <- ext_power[ext_power$CT == 0, ]
# Gather the data for plotting
data_noCT_long <- gather(data_noCT, key = "variable", value = "value",`CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noCT_long, aes(x = SI, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Sibling Interaction",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 4
# Filter the data for b = 0
data_noSI <- ext_power[ext_power$SI== 0, ]
# Gather the data for plotting
data_noSI_long <- gather(data_noSI, key = "variable", value = "value", `CT (m1)`, `SI (m2)`, `CT (m3)`, `SI (m3)`)
# Create the plot
ggplot(data_noSI_long, aes(x = CT, y = value, color = variable)) +
geom_line() +
geom_point() +
labs(title = NULL,
x = "Cultural Transmission",
y = "Power",
color = "Parameter") +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
# Plot 5
gee_power <- read.csv("paper_gee_power.csv")
gee_est <- read.csv("paper_gee_estimates.csv")
p1_gee_data <- gee_power %>%
filter(g == 0) %>%
dplyr::select("b", "p1", "PGS") %>%
mutate(Variable = "CT", Sample = "MZ & DZ") %>%
rename(Confounder = b, Power = p1)
p2_gee_data <- gee_power %>%
filter(b == 0) %>%
dplyr::select("g", "p2", 'PGS') %>%
mutate(Variable = "SI", Sample = "MZ & DZ") %>%
rename(Confounder = g, Power = p2)
gee_mzdz_data <- rbind(p1_gee_data, p2_gee_data) %>%
mutate(PGS_percent = factor(scales::percent(PGS), levels = c("2%", "5%", "10%", "15%"))) %>%
mutate(Method = "Gee")
mx_mzdz_data <- mx_mzdz_data %>%
mutate(Method = "OpenMx")
full_method_data <- rbind(mx_mzdz_data, gee_mzdz_data)
ggplot(data = full_method_data, mapping = aes(x = Confounder, y = Power, color = Variable, linetype = Method)) +
geom_line(linewidth = 0.8) +
geom_point() +
facet_wrap(~PGS_percent) +
scale_linetype_manual(values = c("Gee" = "dotted", "OpenMx" = "solid")) +
jtools::theme_apa() +
theme(text = element_text(family = "serif"))
